MySQL索引

(一)目的
    每次查找数据时, 把磁盘I/O控制在很小量级

(二)B+树
    1)  真实结点放到叶子节点而非内层结点的目的
    增加磁盘块中存储指针数量, 降低树的高度
    (极限情况下, 若块大小==数据项大小, 则索引会退化为线性表)
    
    2)  最左匹配特性
    ('张三', 20, 75), B+树会从最左边第一项开始匹配

(三)索引实现
    1)  MyISAM
    叶节点的data域存放的是数据记录的地址
    主索引和辅助索引在结构上没有任何区别, 但是主索引要求key是唯一的, 而辅助索引的key可以重复.
    索引方式称为"非聚集的"

    2)  InnoDBB
    表数据文件本身就是按照B+树组织的一个索引结构, 树的叶节点的data域保存了完整的数据记录.索引的key是数据表的主键.
    称为"聚集的"
    要求表必须有主键, 未显式指定, 则自动选择一个可以唯一标识记录的列为主键, 或者自动为生成一个隐含字段为主键, 字段为6B, 长整型

(四)如何建立合适索引
    1)  建议永远使用一个与业务无关的自增字段作为主键
    为了方便B+树插入, 这样可以直接插入到B+树的最末端, 避免插入导致的低效的分裂调整
    2)  联合索引
    以一定的顺序引用多个列, 例如一个有序元组<a1, a2, ... an>, 若索引列为A, B, C, 且顺序为A, B, C
    则:
        1>  若查询[A], [A, B], [A, B, C]可以通过索引查询
        2>  若查[A, C], 由于中间缺了B, 只能用到A索引
        3>  若查[B], [C], [B, C], 用不到索引

(五)建立索引的常用技巧
    1)  mysql会一直向右匹配到 >, <, between, like就停止
    eg. a = 1 and b = 2 and c > 3 and d = 4, 会匹配到c
    2)  = 和 in可以乱序
    3)  尽量扩展索引, 不要新建索引