MySQL事务特性

(一)原子性(Atomicity)
一个事务是一个不可分割的工作单位, 其中操作要么全做, 要么都不做, 如果一个sql语句执行失败, 你那么已执行的的语句也回滚, 数据库退回到事务前的状态
1)实现原理  undo log
    当事务对数据库进行修改时, InnoDB会生成对应的undo log. 其属于逻辑日志, 记录sql执行的相关信息

(二)持久性(Durability)
事务一旦提交, 它对数据库的改变就是永久性的, 接下来的其他操作/故障不会对其有任何影响
1)实现原理  redo log
1>  避免每次读写数据都需要磁盘I/O, InnoDB提供了缓存(Buffer Pool), 数据库读取时候, 先从BP中读取, 若没有, 则从磁盘读取后存入BP; 写数据时, 首先写入BP, 定期刷新到磁盘(刷脏)
2>  事务提交时, 会对redo log进行异步刷盘;
redo log时顺序I/O, 会比BP刷盘快很多 
2)redo log与 bin log
1>binlog用于保证服务器基于时间点恢复数据, 还用于主从复制
2>r时InnoDB实现的, b是MySQL服务器曾实现的, 支持很多引擎
3>r是物理日志, b是逻辑日志, 内容是一条条sql

(三)隔离性(Isolation)
事务内部的操作与其他事务是隔离的, 并发执行各个事务之间不能互相干扰. 严格的隔离性是隔离事务级别的(serializable), 但是一般很少使用
1) 锁机制
锁分为表锁, 行锁
表锁在操作数据时会锁定整张表,并发性能较差;行锁是锁定需要操作的数据, 并发性能好.
锁定较多数据的时候使用表锁可以节省大量加锁资源(获得, 检查, 释放锁)
MyISAM只支持表锁, InnoDB同时支持, 绝大数情况下使用行锁

(四)一致性(Consistency)
事务必须使数据库从一个一致性状态变换到另一个一致性状态
事务执行结束后, 数据库的完整性约束没有被破环, 事务执行前后都是合法的数据状态. 包括但不限于:
    实体完整性(行的主键存在且唯一)
    列完整性(字段的类型, 大小, 长度符合要求)
    外键约束
    用户自定义完整性(转账前后, 两个账户的余额之和保持不变)
